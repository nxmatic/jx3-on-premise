apiVersion: kpt.dev/v1alpha1
kind: Kptfile
metadata:
  name: ingress-proxy
packageMetadata:
  shortDescription: proxy ingress load-balancer
openAPI:
  definitions:
    io.k8s.cli.setters.public-key:
      x-k8s-cli:
        setter:
          name: public-key
          value: AAAAB3NzaC1yc2EAAAADAQABAAABAQC772MWTmvnmkQNb6Hno+yZEYxSjxSADFyvnHwBh0pH/nu8/zSh81KiXrgtiPvsGPNap0fFLebYVAC80BC55eUj7fIFtg1/O0+HzwzkFGyIfN46DBMmiJ2/LYHJ7ZXiG9uCtBp+XbSquTwaXKNHvJoBDfEhYDPOpXt1MvdHfPnLV5owUTGAy1ibpfO45Q0RsQuGvDCKtVWn0y/03qvqCUuOcNTdgk9er4lAqVjTpOuEYrcSe+mKFdTeKUFleHM/94xZtwt5k0O8jIT3eKbBCJ1t1jAcxRsIOLe7QunywN2FIGzoiu5XVunwlgFeG6AnVB0pFJNtyExkPDqa++7eW4Lj
          isSet: true
    io.k8s.cli.setters.timezone:
      x-k8s-cli:
        setter:
          name: timezone
          value: Europe/Paris
          isSet: true
    io.k8s.cli.setters.username:
      x-k8s-cli:
        setter:
          name: username
          value: nxmatic
          isSet: true
    io.k8s.cli.setters.domain:
      x-k8s-cli:
        setter:
          name: domain
          value: jxlabs-nos-master.build-jx-prod.build.nuxeo.com
          isSet: true
    io.k8s.cli.substitutions.username-binding:
      x-k8s-cli:
        substitution:
          name: username-binding
          pattern: username=${username}
          values:
          - marker: ${username}
            ref: '#/definitions/io.k8s.cli.setters.username'
    io.k8s.cli.substitutions.public-key-binding:
      x-k8s-cli:
        substitution:
          name: public-key-binding
          pattern: public-key=ssh-rsa ${public-key} ${username}@local
          values:
          - marker: ${public-key}
            ref: '#/definitions/io.k8s.cli.setters.public-key'
          - marker: ${username}
            ref: '#/definitions/io.k8s.cli.setters.username'
    io.k8s.cli.substitutions.fqdn:
      x-k8s-cli:
        substitution:
          name: fqdn
          pattern: ingress-${username}.${domain}
          values:
          - marker: ${username}
            ref: '#/definitions/io.k8s.cli.setters.username'
          - marker: ${domain}
            ref: '#/definitions/io.k8s.cli.setters.domain'
